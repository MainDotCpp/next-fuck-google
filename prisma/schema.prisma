generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model AccessLog {
  id                BigInt   @id @default(autoincrement())
  timestamp         DateTime @default(now())
  path              String
  queryParams       String?
  clientIp          String
  userAgent         String? // 完整的 User-Agent 字符串
  host              String?
  referer           String?
  language          String?
  languageCheckPassed Boolean
  urlParamsCheckPassed Boolean
  dnsCheckPassed    Boolean
  dnsHostnames      String? // JSON 格式的DNS反查域名列表
  dnsError          String?
  apiCheckPassed    Boolean
  apiResponse       String? // JSON 格式的完整 API 响应
  apiError          String?
  allowed           Boolean
  blockedReason     String?
  responseTime      Int // milliseconds

  @@index([timestamp])
  @@index([clientIp])
  @@index([path])
  @@index([allowed])
  @@index([host])
  @@map("access_logs")
}
